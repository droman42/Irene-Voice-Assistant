# Voice Trigger Component Design
## –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≥–æ–ª–æ—Å–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

---

## üéØ **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**

### –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

**üî¥ Python Main Codebase: –ù–ï–¢ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≥–æ–ª–æ—Å–∞**
- –û—Å–Ω–æ–≤–Ω–∞—è Python –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞ (`irene/`) –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è **–ù–ï –ò–ú–ï–ï–¢** –¥–µ—Ç–µ–∫—Ü–∏–∏ wake word
- `VoskRunner` –∏ `MicrophoneInput` –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç **–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏** - –æ–Ω–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –í–°–ï –∞—É–¥–∏–æ –≤—Ö–æ–¥—ã –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- –í—Å–µ –≥–æ–ª–æ—Å–æ–≤—ã–µ –≤—Ö–æ–¥—ã –∏–¥—É—Ç –Ω–∞–ø—Ä—è–º—É—é –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥

**‚úÖ ESP32 Firmware: –ü–û–õ–ù–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø**
- **–û—Å–Ω–æ–≤–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `ESP32/firmware/common/include/audio/wake_word_detector.hpp`
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `ESP32/firmware/common/src/audio/wake_word_detector.cpp`
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: `ESP32/firmware/common/src/core/state_machine.cpp`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - microWakeWord "medium-12-bn" –º–æ–¥–µ–ª—å —Å TensorFlow Lite Micro
  - –ü–µ—Ä-—É–∑–ª–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ wake word (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ `wake_word_training/`)
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –∑–∞–¥–µ—Ä–∂–∫–∏
  - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å audio manager –∏ state machine

### –¢–µ–∫—É—â–∏–π –ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏

```
üé§ Audio Input ‚Üí üó£Ô∏è VOSK ASR ‚Üí üìù ALL Text ‚Üí ‚ö° Command Processing
```

**–ß—Ç–æ –æ–∂–∏–¥–∞–µ—Ç—Å—è —Å VoiceTrigger:**
```
üé§ Audio Input ‚Üí üëÇ Wake Word Detection ‚Üí [TRIGGERED] ‚Üí üó£Ô∏è ASR ‚Üí üìù Text ‚Üí ‚ö° Command Processing
                                      ‚Üí [NOT TRIGGERED] ‚Üí Continue listening
```

---

## üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–°–ª–µ–¥—É—è –ø–∞—Ç—Ç–µ—Ä–Ω—É —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ `irene/core/components.py`:

```python
class VoiceTriggerComponent(Component):
    """Voice trigger detection component - separate from ASR"""
    
    def __init__(self):
        super().__init__("voice_trigger")
        self._detector = None
        
    def get_dependencies(self) -> list[str]:
        return ["openwakeword", "numpy"]  # –ù–ï vosk/whisper
        
    async def initialize(self) -> None:
        """Initialize voice trigger detection model"""
        if not self.is_available():
            raise ComponentNotAvailable("Voice trigger dependencies not available")
        
        # Load wake word detection model
        self.logger.info("Voice trigger component initialized")
        
    async def shutdown(self) -> None:
        """Cleanup voice trigger resources"""
        if self._detector:
            await self._detector.cleanup()
        self.logger.info("Voice trigger component shutdown")
```

### 2. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø–ª–∞–≥–∏–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–ª–µ–¥—É—è –ø–∞—Ç—Ç–µ—Ä–Ω—É `Universal*Plugin`:

```python
# irene/plugins/builtin/universal_voice_trigger_plugin.py
class UniversalVoiceTriggerPlugin(VoiceTriggerPlugin, WebAPIPlugin, CommandPlugin):
    """
    Universal Voice Trigger Plugin - manages multiple wake word providers
    
    Providers:
    - OpenWakeWordProvider (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
    - MicroWakeWordProvider (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å ESP32)
    - PicovoiceProvider (–∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
    - PreciseProvider (Mozilla)
    """
```

### 3. –ü–∞—Ç—Ç–µ—Ä–Ω Provider

```python
# irene/providers/wake_word/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ base.py                    # VoiceTriggerProvider ABC
‚îú‚îÄ‚îÄ openwakeword.py           # OpenWakeWord provider (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ microwakeword.py          # ESP32-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ picovoice.py              # Porcupine wake word
‚îî‚îÄ‚îÄ precise.py                # Mozilla Precise
```

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Input Manager

**–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ –≤ `irene/inputs/microphone.py`:**

```python
class MicrophoneInput(InputSource):
    def __init__(self, 
                 asr_plugin: Optional[ASRPlugin] = None,
                 voice_trigger_plugin: Optional[VoiceTriggerPlugin] = None):
        self.asr_plugin = asr_plugin
        self.voice_trigger_plugin = voice_trigger_plugin
        self._voice_triggered = False
        
    async def listen(self) -> AsyncIterator[str]:
        while self._listening:
            audio_data = await self._get_audio_chunk()
            
            if self.voice_trigger_plugin:
                # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ wake word
                is_triggered = await self.voice_trigger_plugin.detect(audio_data)
                
                if is_triggered:
                    self._voice_triggered = True
                    logger.info("Voice trigger detected!")
                    
                if self._voice_triggered:
                    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å ASR –¥–æ —Ç–∏—à–∏–Ω—ã/—Ç–∞–π–º–∞—É—Ç–∞
                    text = await self.asr_plugin.transcribe_audio(audio_data)
                    if text.strip():
                        yield text
                        self._voice_triggered = False  # –°–±—Ä–æ—Å –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã
            else:
                # –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π —Ä–µ–∂–∏–º (—Ç–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)
                text = await self.asr_plugin.transcribe_audio(audio_data)
                if text.strip():
                    yield text
```

---

## ü§ñ **–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏**

### –ü–æ—á–µ–º—É –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ –º–æ–¥–µ–ª—å, —á—Ç–æ –∏ –¥–ª—è ASR

| –ê—Å–ø–µ–∫—Ç | Wake Word Detection | ASR |
|--------|-------------------|-----|
| **–ó–∞–¥–∞—á–∞** | –î–µ—Ç–µ–∫—Ü–∏—è 1-3 —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Ñ—Ä–∞–∑ | –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π —Ä–µ—á–∏ |
| **–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã** | –í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–∞, –Ω–∏–∑–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ | –ü–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ |
| **–†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏** | –ú–∞–ª–µ–Ω—å–∫–∏–π (1-5MB) | –ë–æ–ª—å—à–æ–π (100MB-1GB) |
| **–†–µ—Å—É—Ä—Å—ã** | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ | –†–µ—Å—É—Ä—Å–æ–µ–º–∫–∏–µ |
| **–¢–æ—á–Ω–æ—Å—Ç—å** | –í—ã—Å–æ–∫–∞—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–ª–æ–≤ | –û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ |

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏

#### ü•á **OpenWakeWord (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

```python
# irene/providers/wake_word/openwakeword.py
class OpenWakeWordProvider(VoiceTriggerProvider):
    """
    OpenWakeWord - Modern, accurate wake word detection
    Models: alexa, hey_jarvis, hey_irene (custom trainable)
    """
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- **–ì–æ—Ç–æ–≤—ã–µ –º–æ–¥–µ–ª–∏**: "alexa", "hey_jarvis" –¥–æ—Å—Ç—É–ø–Ω—ã
- **–ö–∞—Å—Ç–æ–º–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: –ú–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å "hey_irene", "irene"
- **–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
- **–ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: –•–æ—Ä–æ—à–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
- **Python-native**: –õ–µ–≥–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

#### üèÜ **microWakeWord (ESP32 Compatible)**

```python
# irene/providers/wake_word/microwakeword.py
class MicroWakeWordProvider(VoiceTriggerProvider):
    """
    microWakeWord - Compatible with ESP32 models
    Models: medium-12-bn architecture
    """
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- **ESP32 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –¢–µ –∂–µ –º–æ–¥–µ–ª–∏, —á—Ç–æ –≤ firmware
- **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**: –£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ ESP32 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –û–¥–∏–Ω–∞–∫–æ–≤–æ–µ wake word –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- **TensorFlow Lite**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

#### üîß **Picovoice Porcupine**

```python
# irene/providers/wake_word/picovoice.py  
class PicovoiceProvider(VoiceTriggerProvider):
    """
    Picovoice Porcupine - Commercial-grade wake word detection
    Models: Pre-built + custom training available
    """
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- **–ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ**: –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
- **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
- **Edge-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- **–ö–∞—Å—Ç–æ–º–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

| Provider | –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏ | –Ø–∑—ã–∫–∏ | –ö–∞—Å—Ç–æ–º–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ | ESP32 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | –õ–∏—Ü–µ–Ω–∑–∏—è |
|----------|---------------|-------|-------------------|---------------------|----------|
| **OpenWakeWord** | 1-5MB | EN (–≤ –æ—Å–Ω–æ–≤–Ω–æ–º) | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | MIT |
| **microWakeWord** | 140KB | Trainable | ‚úÖ –î–∞ | ‚úÖ –î–∞ | Apache 2.0 |
| **Porcupine** | 1-2MB | Multi | ‚úÖ –ü–ª–∞—Ç–Ω–æ | ‚ùå –ù–µ—Ç | Commercial |
| **Precise** | 20MB | EN | ‚úÖ –°–ª–æ–∂–Ω–æ | ‚ùå –ù–µ—Ç | Apache 2.0 |

---

## ‚öôÔ∏è **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```toml
# config.toml
[components]
microphone = true
voice_trigger = true        # –ù–û–í–´–ô: Voice trigger component
tts = true
asr = true

[components.voice_trigger]
provider = "openwakeword"           # –û—Ç–¥–µ–ª—å–Ω–æ –æ—Ç ASR
wake_words = ["irene", "jarvis"]    # –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ wake words
threshold = 0.8
buffer_seconds = 1.0                # –ë—É—Ñ–µ—Ä –∞—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
timeout_seconds = 5.0               # –¢–∞–π–º–∞—É—Ç –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

[components.voice_trigger.provider_configs.openwakeword]
model_path = "./models/wake_word/"
wake_word_models = { 
    "irene" = "custom_irene_v1.onnx",
    "jarvis" = "hey_jarvis_v2.tflite"
}

[components.asr]  
provider = "vosk"                   # –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
model_path = "./models/vosk/ru_large"

[plugins.universal_voice_trigger]
enabled = true
default_provider = "openwakeword"
providers = ["openwakeword", "microwakeword"]

[plugins.universal_voice_trigger.provider_configs.microwakeword]
model_path = "./models/microwakeword/jarvis_medium.tflite"
frame_length_ms = 30
sample_rate = 16000
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Voice Trigger –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
export IRENE_COMPONENTS__VOICE_TRIGGER__PROVIDER=openwakeword
export IRENE_COMPONENTS__VOICE_TRIGGER__THRESHOLD=0.8
export IRENE_COMPONENTS__VOICE_TRIGGER__WAKE_WORDS=irene,jarvis

# –ü—É—Ç–∏ –∫ –º–æ–¥–µ–ª—è–º
export IRENE_COMPONENTS__VOICE_TRIGGER__MODEL_PATH=/opt/irene/models/wake_word/
```

---

## üîÑ **–ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏**

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞

```mermaid
graph TB
    subgraph "üé§ Audio Input"
        Mic[Microphone Input]
        WebAudio[Web Audio Input]
        FileAudio[File Audio Input]
    end
    
    subgraph "üéØ Voice Trigger Layer"
        VT[VoiceTrigger Component]
        OWW[OpenWakeWord Provider]
        MWW[MicroWakeWord Provider]
        PV[Porcupine Provider]
    end
    
    subgraph "üó£Ô∏è ASR Layer"
        ASR[ASR Component]
        VOSK[VOSK Provider]
        Whisper[Whisper Provider]
    end
    
    subgraph "‚ö° Command Processing"
        CMD[Command Processor]
        Plugins[Command Plugins]
    end
    
    Mic --> VT
    WebAudio --> VT
    FileAudio --> VT
    
    VT --> OWW
    VT --> MWW
    VT --> PV
    
    VT -->|Triggered| ASR
    VT -->|Not Triggered| Mic
    
    ASR --> VOSK
    ASR --> Whisper
    
    ASR --> CMD
    CMD --> Plugins
    
    style VT fill:#ffecb3,stroke:#ff8f00,stroke-width:3px
    style ASR fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style CMD fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
```

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏

```mermaid
sequenceDiagram
    participant Audio as üé§ Audio Input
    participant VT as üéØ VoiceTrigger
    participant ASR as üó£Ô∏è ASR Component
    participant CMD as ‚ö° Command Processor
    
    loop Continuous Listening
        Audio->>VT: Audio chunk
        VT->>VT: Wake word detection
        alt Wake word detected
            VT->>ASR: Triggered - start transcription
            ASR->>CMD: Transcribed text
            CMD->>Audio: Command result
        else No wake word
            VT->>Audio: Continue listening
        end
    end
    
    Note over VT,ASR: Voice trigger runs continuously<br/>ASR only when activated
```

---

## üåê **Web API Integration**

### –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

```python
# Web API —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ UniversalVoiceTriggerPlugin
@app.post("/voice_trigger/detect")
async def detect_wake_word(audio: UploadFile):
    """Test wake word detection on uploaded audio"""
    
@app.post("/voice_trigger/train")
async def train_wake_word(samples: List[UploadFile], wake_word: str):
    """Train custom wake word model"""
    
@app.get("/voice_trigger/status")
async def voice_trigger_status():
    """Get voice trigger detection status and stats"""
    
@app.get("/voice_trigger/providers")
async def list_providers():
    """List available voice trigger providers"""
    
@app.post("/voice_trigger/threshold")
async def set_threshold(threshold: float):
    """Update detection threshold"""
```

---

## üöÄ **–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### Phase 1: Core Infrastructure
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `VoiceTriggerComponent` –≤ `irene/core/components.py`
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å `VoiceTriggerProvider` –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –≤ `irene/providers/wake_word/base.py`
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å voice trigger –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `irene/config/models.py`
4. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `ComponentManager` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ voice trigger

### Phase 2: Provider Implementation
1. üîÑ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `OpenWakeWordProvider` (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
2. üîÑ –î–æ–±–∞–≤–∏—Ç—å `MicroWakeWordProvider` –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É
3. üîÑ –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π
4. üîÑ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å asset management —Å–∏—Å—Ç–µ–º–æ–π

### Phase 3: Integration
1. üîÑ –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `MicrophoneInput` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ voice trigger
2. üîÑ –°–æ–∑–¥–∞—Ç—å `UniversalVoiceTriggerPlugin`
3. üîÑ –û–±–Ω–æ–≤–∏—Ç—å `ComponentManager` –∏ deployment profiles
4. üîÑ –î–æ–±–∞–≤–∏—Ç—å voice trigger –≤ input/output pipeline

### Phase 4: Web API & Tools
1. üîÑ –î–æ–±–∞–≤–∏—Ç—å voice trigger Web API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
2. üîÑ –°–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –æ–±—É—á–µ–Ω–∏—è/—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è wake word
3. üîÑ –î–æ–±–∞–≤–∏—Ç—å voice trigger —Å—Ç–∞—Ç—É—Å –≤ health checks
4. üîÑ –°–æ–∑–¥–∞—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è voice trigger

### Phase 5: ESP32 Integration
1. üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ESP32 TensorFlow Lite –º–æ–¥–µ–ª–µ–π –≤ Python-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Ñ–æ—Ä–º–∞—Ç
2. üîÑ –û–±—â–∏–π –ø–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è wake word –º–µ–∂–¥—É ESP32 –∏ Python
3. üîÑ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç wake word –º–æ–¥–µ–ª–µ–π –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º–µ

---

## üì¶ **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

### –ì—Ä—É–ø–ø—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ë–∞–∑–æ–≤–∞—è voice trigger —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
uv add irene-voice-assistant[voice-trigger]

# OpenWakeWord (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
uv add openwakeword torch torchaudio

# MicroWakeWord (ESP32 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
uv add microwakeword tensorflow-lite

# Picovoice Porcupine (–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π)
uv add pvporcupine

# –ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å voice trigger
uv add irene-voice-assistant[voice,voice-trigger]
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å voice trigger –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
python -m irene.runners.cli --check-voice-trigger

# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å voice trigger
python -c "from irene.utils.loader import get_voice_trigger_status; print(get_voice_trigger_status())"
```

---

## üîß **Deployment Profiles Update**

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```python
# –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ deployment profiles –≤ ComponentManager
def get_deployment_profile(self) -> str:
    available = set(self._components.keys())
    
    if {"microphone", "voice_trigger", "asr", "tts", "web_api"} <= available:
        return "Smart Voice Assistant"      # –ù–û–í–´–ô: Voice trigger –≤–∫–ª—é—á–µ–Ω
    elif {"microphone", "asr", "tts", "web_api"} <= available:
        return "Continuous Voice Assistant" # –¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
    elif {"voice_trigger", "web_api"} <= available:
        return "Voice Trigger API Server"   # –ù–û–í–´–ô: –¢–æ–ª—å–∫–æ voice trigger API
    elif "web_api" in available:
        return "API Server"
    else:
        return "Headless"
```

---

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: Wake word –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ, ASR —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
2. **–¢–æ—á–Ω–æ—Å—Ç—å**: –ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Å–≤–æ–µ–π —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–∏  
3. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–µ—Å—É—Ä—Å–æ–≤**: –ú–∞–ª–µ–Ω—å–∫–∞—è wake word –º–æ–¥–µ–ª—å vs –±–æ–ª—å—à–∞—è ASR –º–æ–¥–µ–ª—å
4. **–ì–∏–±–∫–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å wake word –º–æ–¥–µ–ª–∏ –±–µ–∑ –≤–ª–∏—è–Ω–∏—è –Ω–∞ ASR
5. **–ú—É–ª—å—Ç–∏-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –û–¥–∏–Ω–∞–∫–æ–≤—ã–π –æ–ø—ã—Ç wake word –Ω–∞ ESP32 –∏ Python
6. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å graceful degradation
7. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ wake word

---

## üéì **–û–±—É—á–µ–Ω–∏–µ Wake Word –º–æ–¥–µ–ª–µ–π**

### –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –æ–±—É—á–µ–Ω–∏—è

VoiceTrigger –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –æ–±—É—á–µ–Ω–∏—è wake word –º–æ–¥–µ–ª–µ–π:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –æ–±—É—á–µ–Ω–∏—è (if working in project directory)
uv sync --extra wake-word-training

# Or if installing as external package:
# uv add irene-voice-assistant[wake-word-training]

# –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
irene-record-samples --wake_word irene --speaker_name your_name --num_samples 50
irene-train-wake-word irene --epochs 55 --batch_size 16
irene-validate-model models/irene_medium_*.tflite

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
irene-convert-to-onnx models/irene_medium_*.tflite    # ‚Üí OpenWakeWord
irene-convert-to-tflite models/irene_medium_*.tflite  # ‚Üí Python microWakeWord
irene-convert-to-esp32 models/irene_medium_*.tflite   # ‚Üí ESP32 firmware
```

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π

| –¢–∏–ø –æ–±—É—á–µ–Ω–∏—è | OpenWakeWord Provider | MicroWakeWord Provider | ESP32 Firmware |
|-------------|---------------------|----------------------|----------------|
| **microWakeWord** | ‚úÖ Via ONNX | ‚úÖ Native TFLite | ‚úÖ Native C headers |
| **OpenWakeWord** | ‚úÖ Native ONNX | ‚ùå –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è | ‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è |
| **Custom Training** | ‚úÖ ONNX export | ‚úÖ TFLite export | ‚úÖ C header export |

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –æ–±—É—á–µ–Ω–∏—é

- **–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ**: `wake_word_training/README.md`
- **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: `wake_word_training/USAGE_EXAMPLE.md`
- **ESP32 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: `ESP32/firmware/GETTING_STARTED.md`

---

## üìû **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π**

–≠—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Irene v13:

- ‚úÖ **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** —Å graceful degradation
- ‚úÖ **Universal Plugin + Provider** –ø–∞—Ç—Ç–µ—Ä–Ω
- ‚úÖ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- ‚úÖ **Web API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç—å** —á–µ—Ä–µ–∑ TOML/ENV
- ‚úÖ **–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å** (CLI, voice, web –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏)
- ‚úÖ **Dependency Injection** –∏ —á–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–≠—Ç–æ—Ç –¥–∏–∑–∞–π–Ω –∑–∞–ø–æ–ª–Ω—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø—Ä–æ–±–µ–ª –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç Python —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –ø–∞—Ä–∏—Ç–µ—Ç—É —Å ESP32 firmware, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –º–æ–¥—É–ª—å–Ω—É—é, —Ä–∞—Å—à–∏—Ä—è–µ–º—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä—É—é –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç v13. 